<div >
  <ng-container *ngIf="isCustomer">
    <mat-tab-group
      class="mat-steps"
      [selectedIndex]="currentMainIndex"
      (selectedIndexChange)="changeMainTab($event)"
    >
      <ng-container *ngFor="let link of mainTabCustomers; let j = index">
        <mat-tab
          [disabled]="
            !link.role?.includes(
              tokenService?.getRoleInBusinessAccountIdToken()
            )
          "
        >
          <ng-template mat-tab-label>
            <span
              >{{ link.label }}
              <span *ngIf="j == currentMainIndex && pageConfig.totalElements"
                >({{ pageConfig?.totalElements }})</span
              >
            </span>
          </ng-template>
          <ng-template matTabContent>
            <ng-container *ngIf="currentMainIndex == 0">
              <ng-container>
                <div class="header-wrapper my-2">
                  <div class="row mx-auto">
                    <div class="col-md-6 col-12 px-0">
                      <div class="filters">
                        <search-filter
                          (inputChange)="onInput($event)"
                          [placeholder]="'Search Based On Code/Name'"
                        ></search-filter>
                      </div>
                    </div>
                    <div
                      class="col-md-6 my-1 px-0 col-12 d-flex justify-content-end align-items-center align-items-center"
                    >
                      <div class="action-btns">
                        <dadyin-button
                          [theme]="'primary'"
                          label="Add Customer"
                          [routerLink]="['/home/customer/add']"
                        >
                        </dadyin-button>
                            <dadyin-button
                          [theme]="'primary'"
                          label="Generate PDF JSON"
                          (clicked)="generatePdfWithAddressFromJson()"
                        >
                        </dadyin-button>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="content-wrapper mt-2">
                  <data-table
                    [data]="lcpDetails"
                    [headers]="headers"
                    [searchTerm]="filterValue"
                    [pageConfig]="pageConfig"
                    (editData)="editRecord($event)"
                    (sortChange)="sort($event)"
                    (pageChange)="pageChange($event)"
                    [actions]="tableActions"
                    (actionClick)="onActionClick($event)"
                    (rowChange)="onEdit($event)"
                  >
                  </data-table>
                </div>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="currentMainIndex == 1">
              <ng-container>
                <div class="header-wrapper my-2">
                  <div class="row mx-auto">
                    <div class="col-md-6 col-12 px-0">
                      <div class="filters">
                        <search-filter
                          (inputChange)="onInput($event)"
                          [placeholder]="
                            'Search Based On Customer Code/Customer Name'
                          "
                        ></search-filter>
                      </div>
                    </div>
                    <div
                      class="col-md-6 col-12 px-0 d-flex justify-content-end align-items-center align-items-center px-0"
                    >
                      <div
                        *ngIf="bulkAssignmentIds?.length > 0"
                        class="action-btns"
                      >
                        <dadyin-button
                          [theme]="'primary'"
                          label="Generate PDF"
                          (clicked)="generatePdfWithAddress()"
                        >
                        </dadyin-button>
                      </div>
                      <div class="action-btns">
                        <dadyin-button
                          [theme]="'primary'"
                          label="Add Customer"
                          [routerLink]="['/home/customer/add']"
                        >
                        </dadyin-button>
                    
                      </div>
                    </div>
                  </div>
                </div>
                <div class="content-wrapper mt-2">
                  <data-table
                    [data]="customerDetails"
                    [headers]="headers"
                    [searchTerm]="filterValue"
                    [pageConfig]="pageConfig"
                    (editData)="editRecord($event)"
                    (sortChange)="sort($event)"
                    (pageChange)="pageChange($event)"
                    [actions]="tableActionCustomers"
                    (actionClick)="onActionClick($event)"
                    (rowChange)="onEdit($event)"
                    (rowSelection)="onRowSelection($event)"
                  >
                  </data-table>
                </div>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="currentMainIndex == 2">
              <ng-container>
                <div class="header-wrapper my-2">
                  <div class="row mx-auto">
                    <div class="col-md-6 col-12 px-0 my-1">
                      <div class="filters d-flex w-100 align-items-center">
                        <search-filter
                          style="width: 100%"
                          (inputChange)="onInput($event)"
                          [placeholder]="
                            'Search Based On Customer Code/Customer Name'
                          "
                        ></search-filter>
                        <app-lead-filter-box
                          (emitFilterLeads)="filterLeads($event)"
                        ></app-lead-filter-box>
                        <dadyin-button
                          *ngIf="
                            this.tokenService.getRoleInBusinessAccountIdToken() !=
                            'CRM'
                          "
                          [theme]="
                            unassignedFilter ? 'primary' : 'borderless-primary'
                          "
                          typeval="no_accounts_outline"
                          type="icon"
                          [matTooltip]="
                            unassignedFilter
                              ? 'View All Leads'
                              : 'View only Unassigned Leads'
                          "
                          (clicked)="filterUnassignedLeads()"
                        >
                        </dadyin-button>
                        <dadyin-button
                          *ngIf="
                            this.tokenService.getRoleInBusinessAccountIdToken() !=
                            'CRM'
                          "
                          [theme]="'borderless-primary'"
                          type="icon"
                          typeval="download"
                          matTooltip="Download Sample file"
                          (clicked)="downloadSampleFile()"
                        >
                        </dadyin-button>
                        <dadyin-button
                          *ngIf="
                            this.tokenService.getRoleInBusinessAccountIdToken() !=
                            'CRM'
                          "
                          [theme]="'borderless-primary'"
                          type="icon"
                          typeval="upload"
                          matTooltip="Bulk Upload"
                          (clicked)="fileinp.click()"
                        >
                        </dadyin-button>
                        <input
                          (change)="onExcelUpload($event, fileinp)"
                          type="file"
                          multiple="false"
                          style="display: none !important"
                          #fileinp
                          accept=".xlsx,.csv,.xls"
                        />
                        <div
                          *ngIf="bulkAssignmentIds?.length > 0"
                          class="action-btns"
                        >
                          <dadyin-button
                            [theme]="'primary'"
                            label="Generate PDF"
                            (clicked)="generatePdfWithAddress()"
                          >
                          </dadyin-button>
                        </div>
                      </div>
                    </div>
                    <div
                      class="col-md-6 px-0 col-12 d-flex justify-content-start align-items-center"
                    >
                      <div
                        class="w-100 d-flex align-items-center"
                        *ngIf="
                          this.tokenService.getRoleInBusinessAccountIdToken() !=
                          'CRM'
                        "
                      >
                        <ng-select
                          [(ngModel)]="salesRepIds"
                          [multiple]="true"
                          [searchable]="true"
                          [clearable]="false"
                          class="custom custom-multiple-table w-100 mx-2"
                          placeholder="Select Sales Rep."
                          [items]="businessAccountService.employeesList"
                          labelForId="yesno"
                          bindValue="id"
                          bindLabel="firstName"
                        >
                          <ng-template ng-multi-label-tmp let-items="items">
                            <ng-container *ngIf="items.length <= 3">
                              <div
                                *ngFor="let item of items | slice : 0 : 3"
                                class="ng-value"
                                style="margin-right: 3px !important"
                              >
                                <span
                                  [matTooltip]="item.firstName"
                                  class="ng-value-label"
                                >
                                  {{ item.firstName }}
                                </span>
                              </div>
                            </ng-container>

                            <div *ngIf="items.length > 3" class="ng-value">
                              <span class="ng-value-label">{{
                                items.length
                              }}</span>
                            </div>
                          </ng-template>
                          <ng-template
                            ng-label-tmp
                            let-item="item"
                            let-clear="clear"
                          >
                            <span
                              [matTooltip]="item.email"
                              class="ng-value-label"
                            >
                              {{ item.firstName }}
                            </span>
                            <span
                              class="ng-value-icon right"
                              (click)="clear(item)"
                              aria-hidden="true"
                              >Ã—</span
                            >
                          </ng-template>

                          <ng-template ng-option-tmp let-item="item">
                            <span
                              [matTooltip]="item.email"
                              class="ng-value-label"
                            >
                              {{ item.firstName }}
                            </span>
                          </ng-template>
                        </ng-select>
                        <div class="attribute tabular-sheet">
                          <div class="attribute-input">
                            <div class="toggle mx-2 bg-white height-28">
                              <button
                                style="
                                  min-width: unset;
                                  border-bottom-left-radius: 10px;
                                  border-top-left-radius: 10px;
                                "
                                class="bg-primary text-white height-28"
                                [ngClass]="{
                                  disabled:
                                    bulkAssignmentIds?.length == 0 ||
                                    salesRepIds?.length == 0
                                }"
                                [disabled]="
                                  bulkAssignmentIds?.length == 0 ||
                                  salesRepIds?.length == 0
                                "
                                (click)="assignLeads()"
                              >
                                Assign
                              </button>
                              <button
                                style="min-width: unset"
                                class="bg-secondary text-primary height-28"
                                [ngClass]="{
                                  disabled:
                                    bulkAssignmentIds?.length == 0 ||
                                    salesRepIds?.length == 0
                                }"
                                [disabled]="
                                  bulkAssignmentIds?.length == 0 ||
                                  salesRepIds?.length == 0
                                "
                                (click)="unassignLeads()"
                              >
                                Unassign
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="d-flex w-100 align-items-center">
                        <select
                          style="max-width: 150px"
                          class="b-light w-100 b-round"
                          [(ngModel)]="relationStatusId"
                          placeholder="Select Status"
                        >
                          <option [value]="null" disabled>Select Status</option>
                          <option
                            *ngFor="let item of apiService.allRelationStatuses"
                            [value]="item.id"
                          >
                            {{ item.description }}
                          </option>
                        </select>
                        <dadyin-button
                          [isDisabled]="
                            bulkAssignmentIds?.length == 0 || !relationStatusId
                          "
                          class="mx-1 height-28"
                          [theme]="'primary'"
                          label="Assign Status"
                          (clicked)="assignRelationStatus()"
                        ></dadyin-button>
                        <dadyin-button
                          [theme]="'primary'"
                          label="Add Lead"
                          class="mx-1 height-28"
                          [routerLink]="['/home/lead/add']"
                        >
                        </dadyin-button>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="content-wrapper mt-2">
                  <ng-container *ngIf="!edit">
                    <data-table
                      [data]="leadDetails"
                      [headers]="headers"
                      [searchTerm]="filterValue"
                      [pageConfig]="pageConfig"
                      (editData)="editRecord($event)"
                      (sortChange)="sort($event)"
                      (pageChange)="pageChange($event)"
                      (rowChange)="onEdit($event)"
                      [actions]="tableActionLeads"
                      (actionClick)="onActionClick($event)"
                      (rowSelection)="onRowSelection($event)"
                    >
                    </data-table>
                  </ng-container>
                </div>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="currentMainIndex == 3">
              <ng-container>
                <div class="header-wrapper my-2">
                  <div class="row mx-auto">
                    <div class="col-6 px-0">
                      <div class="filters">
                        <search-filter
                          (inputChange)="onInput($event)"
                          [placeholder]="
                            'Search Based On Customer Code/Customer Name'
                          "
                        ></search-filter>
                      </div>
                    </div>
                    <div
                      class="col-6 px-0 d-flex justify-content-end align-items-center align-items-center"
                    >
                      <dadyin-button
                        [theme]="'primary'"
                        label="Add Prospect"
                        [routerLink]="['/home/prospect/add']"
                      >
                      </dadyin-button>
                    </div>
                  </div>
                </div>
                <div class="content-wrapper mt-2">
                  <data-table
                    [data]="prospectDetails"
                    [headers]="headers"
                    [searchTerm]="filterValue"
                    [pageConfig]="pageConfig"
                    (editData)="editRecord($event)"
                    (rowChange)="onEdit($event)"
                    (sortChange)="sort($event)"
                    (pageChange)="pageChange($event)"
                    [actions]="tableActionProspects"
                    (actionClick)="onActionClick($event)"
                  >
                  </data-table>
                </div>
              </ng-container>
            </ng-container>
          </ng-template>
        </mat-tab>
      </ng-container>
    </mat-tab-group>
  </ng-container>
  <ng-container *ngIf="!isCustomer">
    <mat-tab-group class="mat-steps">
      <ng-container *ngFor="let link of mainTabVendors">
        <mat-tab>
          <ng-template mat-tab-label>
            <span>{{ link.label }}</span>
          </ng-template>
          <ng-template matTabContent>
            <ng-container *ngIf="currentMainIndex == 0">
              <ng-container>
                <div class="header-wrapper my-2">
                  <div class="row mx-auto">
                    <div class="col-6 px-0">
                      <search-filter
                        (inputChange)="onInput($event)"
                        [placeholder]="
                          'Search Based On Vendor Code/Vendor Name'
                        "
                      ></search-filter>
                    </div>
                    <div
                      class="col-6 px-0 d-flex justify-content-end align-items-center align-items-center"
                    >
                      <div class="action-btns">
                        <dadyin-button
                          [theme]="'primary'"
                          label="Add Vendor"
                          [routerLink]="['/home/vendor/add']"
                        >
                        </dadyin-button>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="content-wrapper mt-2">
                  <data-table
                    [data]="vendorDetails"
                    [headers]="headers"
                    [searchTerm]="filterValue"
                    [pageConfig]="pageConfig"
                    (editData)="editRecord($event)"
                    (sortChange)="sort($event)"
                    (pageChange)="pageChange($event)"
                    [actions]="tableActionsVendor"
                    (actionClick)="onActionClick($event)"
                  >
                  </data-table>
                </div>
              </ng-container>
            </ng-container>
          </ng-template>
        </mat-tab>
      </ng-container>
    </mat-tab-group>
  </ng-container>
</div>
