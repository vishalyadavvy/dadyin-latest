<form>
  <mat-expansion-panel expanded="true" #expansionPanel1>
    <mat-expansion-panel-header (click)="expandPanel(expansionPanel1, $event)">
      <mat-panel-description>
        <div class="w-100 title-text">Container Overview</div>
      </mat-panel-description>
    </mat-expansion-panel-header>

    <ng-template matExpansionPanelContent>
      <div class="row" [formGroup]="containerForm">
        <div class="col-3 map-grid" *ngIf="isExport">
          <dadyin-searchable-select
            (changed)="onChangeCustomer()"
            class="w-100"
            label="{{
              isQuotation ? 'Container Quote To' : 'Container Order To'
            }}"
            [control]="requestToId"
            [fullItems]="businessAccountService.customerList"
            bindValue="relationAccountId"
            bindLabel="relationAccountName"
          ></dadyin-searchable-select>
          <dadyin-button
            (clicked)="openMap(2)"
              (click)="$event.stopPropagation()"
            [theme]="'borderless-primary'"
            type="icon"
            typeval="map"
          >
          </dadyin-button>

          <div *ngIf="map2" class="tooltip-white b-light shadow-sm">
            {{ requestToAddress }}
          </div>
        </div>
        <div class="col-3 map-grid" *ngIf="!isExport">
          <dadyin-searchable-select
            (changed)="onChangeVendor()"
            class="w-100"
            label="{{
              isQuotation ? 'Container Quote From' : 'Container Order From'
            }}"
            [fullItems]="businessAccountService.exportersVendorList"
            [control]="requestFromId"
            bindValue="relationAccountId"
            bindLabel="relationAccountName"
          ></dadyin-searchable-select>
          <dadyin-button
            (clicked)="openMap(1)"
              (click)="$event.stopPropagation()"
            [theme]="'borderless-primary'"
            type="icon"
            typeval="map"
          >
          </dadyin-button>

          <div *ngIf="map1" class="tooltip-white b-light shadow-sm">
            {{ requestToAddress }}
          </div>
        </div>

        <div class="col-3">
          <div class="row">
            <div class="col-6" formGroupName="containerTypeInformation">
              <dadyin-select
                [optionArr]="containerService.containerTypesList"
                label="Container Size"
                formControlName="containerTypeId"
                optionLabel="label"
                optionValue="id"
                [emptyOption]="'Container order from'"
                (selectedStateChange)="onContainerTypeChange()"
              >
              </dadyin-select>
            </div>
            <div class="col-6">
              <dadyin-select
                [optionArr]="containerService.incoTermsList"
                [emptyOption]="'Select Inco Terms'"
                label="Inco Terms"
                formControlName="incoTermId"
                optionLabel="description"
                optionValue="id"
              >
              </dadyin-select>
            </div>
          </div>
        </div>

        <div class="col-3">
          <div class="row">
            <div class="col-6">
              <dadyin-input
                inputType="date"
                formControlName="date"
                label="Date"
              >
              </dadyin-input>
            </div>
            <div class="col-6">
              <dadyin-input
                inputType="date"
                isDisabled="true"
                formControlName="editTillDate"
                label="Edit Till Date"
              >
              </dadyin-input>
            </div>
          </div>
        </div>

        <ng-container>
          <div class="col-3">
            <div class="row">
              <div class="col-6">
                <dadyin-input
                  inputType="date"
                  formControlName="gateOpenDate"
                  label="Gate Open Date"
                >
                </dadyin-input>
              </div>
              <div class="col-6">
                <dadyin-input
                  inputType="date"
                  formControlName="gateCloseDate"
                  label="Gate Close Date"
                >
                </dadyin-input>
              </div>
            </div>
          </div>
        </ng-container>

        <ng-container>
          <div class="col-3">
            <div class="row">
              <div class="col-6">
                <dadyin-select
                  [optionArr]="containerService.employeesList"
                  label="Handling Manager"
                  formControlName="handlingManagerId"
                  optionLabel="firstName"
                  optionValue="id"
                  [emptyOption]="'Handling Manager'"
                >
                </dadyin-select>
              </div>
              <div class="col-6">
                <dadyin-input
                  inputType="date"
                  formControlName="loadingDate"
                  label="Loading Date"
                >
                </dadyin-input>
              </div>
            </div>
          </div>
        </ng-container>

        <div class="col-3">
          <div class="row">
            <div class="col-6" formGroupName="containerTypeInformation">
              <div class="attribute one">
                <label for="">Wt. Capacity</label>
                <div class="attribute-input" formGroupName="weight">
                  <input
                    (change)="calculateValues()"
                    min="0"
                    formControlName="attributeValue"
                    type="number"
                    placeholder="Enter your value"
                  />
                  <select
                    (change)="calculateValues()"
                    formControlName="userConversionUom"
                    id="NetWtUnit"
                  >
                    <ng-container
                      *ngFor="let item of uomService?.availableNetWeightUoms"
                    >
                      <option [value]="item.description">
                        {{ item?.description }}
                      </option>
                    </ng-container>
                  </select>
                </div>
              </div>
            </div>
            <div class="col-6" formGroupName="containerTypeInformation">
              <div class="attribute one">
                <label for="">Vol. Capacity</label>
                <div class="attribute-input" formGroupName="volume">
                  <input
                    (change)="calculateValues()"
                    min="0"
                    formControlName="attributeValue"
                    type="number"
                    placeholder="Enter your value"
                  />
                  <select
                    (change)="calculateValues()"
                    formControlName="userConversionUom"
                    id="NetWtUnit"
                  >
                    <ng-container
                      *ngFor="let item of uomService?.availableNormalVolumeUoms"
                    >
                      <option [value]="item.description">
                        {{ item?.description }}
                      </option>
                    </ng-container>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-3">
          <div class="row">
            <div class="col-6">
              <dadyin-select
                [emptyOption]="'Select Departure Port'"
                [optionArr]="containerService.portsList"
                label="Port of Departure"
                formControlName="departurePortId"
                optionLabel="description"
                optionValue="id"
              >
              </dadyin-select>
            </div>

            <div class="col-6">
              <dadyin-select
                [emptyOption]="'Select Arrival List'"
                [optionArr]="containerService.portsList"
                label="Port of arrival"
                formControlName="arrivalPortId"
                optionLabel="description"
                optionValue="id"
              >
              </dadyin-select>
            </div>
          </div>
        </div>

        <div class="col-3">
          <div class="row">
            <div class="col-6">
              <dadyin-input
                inputType="date"
                formControlName="departureDate"
                label="Departure Date(ETD)"
              >
              </dadyin-input>
            </div>

            <div class="col-6">
              <dadyin-input
                inputType="date"
                formControlName="arrivalDate"
                label="Arrival Date(ETA)"
              >
              </dadyin-input>
            </div>
          </div>
        </div>

        <div class="col-3">
          <div class="row">
            <div class="col-6">
              <dadyin-select
                [emptyOption]="'Select Payment Term'"
                formControlName="paymentTermId"
                [optionArr]="containerService.paymentTermsList"
                label="Payment Terms"
                optionLabel="description"
                optionValue="id"
              >
              </dadyin-select>
            </div>

            <div class="col-6">
              <dadyin-select
                [emptyOption]="'Select Loading Location'"
                formControlName="branchId"
                [optionArr]="containerService.branchesList"
                label="Loading Location"
                optionLabel="name"
                optionValue="id"
              >
              </dadyin-select>
            </div>
          </div>
        </div>

        <div class="col-3">
          <div class="row">
            <div class="col-6">
              <dadyin-input
                inputType="text"
                formControlName="containerNumber"
                label="Container Reference #"
              >
              </dadyin-input>
            </div>
            <div class="col-6">
              <dadyin-input
                inputType="text"
                formControlName="vesselName"
                label="Vessel Name"
              >
              </dadyin-input>
            </div>
          </div>
        </div>

        <div class="col-3">
          <div class="row">
            <div class="col-6">
              <dadyin-input
                inputType="text"
                formControlName="vesselNumber"
                label="Vessel #"
              >
              </dadyin-input>
            </div>
          </div>
        </div>
      </div>
    </ng-template>
  </mat-expansion-panel>

  <mat-expansion-panel
    class="panel-no-padding mt-4"
    expanded="false"
    #expansionPanel2
  >
    <mat-expansion-panel-header (click)="expandPanel(expansionPanel2, $event)">
      <mat-panel-description
        class="d-flex justify-content-between"
        [formGroup]="containerForm"
      >
        <div class="primary-text font-size-12 d-flex align-items-center">
          <div class="title-text me-5">Order Overview</div>

          <div>Filled Odometer:</div>
          <div
            class="bg-white mar-left-2"
            style="min-width: 80px"
            [ngStyle]="{
              color:
                containerForm.get('filledOdometer').get('odometerType').value ==
                'Weight'
                  ? '#03266d'
                  : '#3E7FFF'
            }"
          >
            {{
              containerForm.get("filledOdometer").get("odometerType").value
                | slice : 0 : 1
            }}{{ containerForm.get("filledOdometer").get("value").value }}
          </div>
        </div>

        <div
          class="d-flex align-items-center text-primary"
          formGroupName="containerTypeInformation"
        >
          <span class="font-size-12"> Container Size : </span>
          <dadyin-select
            class="mb-0"
            [optionArr]="containerService.containerTypesList"
            formControlName="containerTypeId"
            optionLabel="label"
            optionValue="id"
            [emptyOption]="'Container order from'"
            (selectedStateChange)="onContainerTypeChange()"
          >
          </dadyin-select>
          <span class="font-size-12 mx-2"> | ODO : </span>

          <span
            class="bg-white b-round mar-left-2 px-2 font-size-12"
            style="min-width: 80px"
          >
            {{ getCentralOdometerValue() | numberFormatter : 3 }} VW
          </span>
        </div>

        <div class="primary-text font-size-12 d-flex align-items-center">
          Remaining Odometer:
          <div
            class="bg-white mar-left-2"
            style="min-width: 80px"
            [ngStyle]="{
              color:
                containerForm.get('remainingOdometer').get('odometerType')
                  .value == 'Weight'
                  ? '#03266d'
                  : '#3E7FFF'
            }"
          >
            {{
              containerForm.get("remainingOdometer").get("odometerType").value
                | slice : 0 : 1
            }}{{ containerForm.get("remainingOdometer").get("value").value }}
          </div>
        </div>
      </mat-panel-description>
    </mat-expansion-panel-header>

    <ng-template matExpansionPanelContent>
      <div class="row" *ngIf="containerData">
        <app-three-scene
          #threejs
          class="grid-threejs"
          [containerData]="containerData"
        ></app-three-scene>
      </div>
    </ng-template>
  </mat-expansion-panel>

  <div class="row align-items-center bg-light py-2 mt-4">
    <div class="attribute tabular-sheet col-3 mx-1">
      <div class="attribute-input bg-white">
        <div class="toggle width-perc-100">
          <button
            (click)="poView = 'productWise'"
            class="width-perc-50"
            [ngClass]="{ active: poView == 'productWise' }"
          >
            Product Wise
          </button>
          <button
            (click)="poView = 'orderWise'"
            class="width-perc-50"
            [ngClass]="{ active: poView == 'orderWise' }"
          >
            Order Wise
          </button>
        </div>
      </div>
    </div>
    <div class="col-5">
      <div class="d-flex">
        <div class="title-text">Weight</div>
        <div class="fill-line">
          <div
            [style.width]="getWeightWidth() + '%'"
            [ngClass]="{ 'b-warning': getWeightWidth() > 100 }"
            class="progress-line"
          ></div>
        </div>
      </div>
      <div class="d-flex mt-2">
        <div class="title-text">Volume</div>
        <div class="fill-line">
          <div
            [style.width]="getVolumeWidth() + '%'"
            [ngClass]="{ 'b-warning': getVolumeWidth() > 100 }"
            class="progress-line"
          ></div>
        </div>
      </div>
    </div>
    <div class="col-2">
      <div class="attribute one">
        <div class="attribute-input bg-white">
          <div style="width: 60%; padding-left: 2%">
            {{
              containerForm.get("weight").get("attributeValue").value
                | numberFormatter : 3
            }}
            <span> / </span>
            {{
              containerForm
                .get("containerTypeInformation")
                .get("weight")
                .get("attributeValue").value | numberFormatter : 3
            }}
          </div>
          <select
            disabled
            [formControl]="
              containerForm
                .get('containerTypeInformation')
                .get('weight')
                .get('userConversionUom')
            "
            style="width: 40%"
            id="NetWtUnit"
          >
            <ng-container
              *ngFor="let item of uomService?.availableNetWeightUoms"
            >
              <option disabled [value]="item.description">
                {{ item?.description }}
              </option>
            </ng-container>
          </select>
        </div>
      </div>
      <div class="attribute one mt-2">
        <div class="attribute-input bg-white">
          <div style="width: 60%; padding-left: 2%">
            {{
              containerForm.get("volume").get("attributeValue").value
                | numberFormatter : 3
            }}
            <span> / </span>
            {{
              containerForm
                .get("containerTypeInformation")
                .get("volume")
                .get("attributeValue").value
            }}
          </div>
          <select
            disabled
            [formControl]="
              containerForm
                .get('containerTypeInformation')
                .get('volume')
                .get('userConversionUom')
            "
            style="width: 40%"
          >
            <ng-container
              *ngFor="let item of uomService?.availableNormalVolumeUoms"
            >
              <option disabled [value]="item.description">
                {{ item?.description }}
              </option>
            </ng-container>
          </select>
        </div>
      </div>
    </div>

    <div class="col-1 text-right">
      <dadyin-button
        [theme]="'borderless-primary'"
        type="icon"
        [typeval]="'print'"
        height="33px"
      >
      </dadyin-button>
      <dadyin-button
        [theme]="'borderless-primary'"
        type="icon"
        [typeval]="'download'"
        height="33px"
      >
      </dadyin-button>
    </div>
  </div>

  <!-- // related to Purchaseorders  -->

  <ng-container *ngIf="!isQuotation">
    <mat-expansion-panel
      class="panel-no-padding mt-4"
      expanded="true"
      #expansionPanel3
    >
      <mat-expansion-panel-header
        (click)="expandPanel(expansionPanel3, $event)"
      >
        <mat-panel-description>
          <div
            *ngIf="poView == 'orderWise'"
            class="text-start w-100 title-text"
          >
            {{ isExport ? "SOs" : "POs" }} in Container ({{
              containerOrders?.controls?.length
            }})
          </div>
          <div *ngIf="poView == 'productWise'" class="w-100 title-text">
            Products in Container ({{ containerOrders?.controls?.length }})
          </div>
        </mat-panel-description>
      </mat-expansion-panel-header>

      <ng-template matExpansionPanelContent>
        <div *ngIf="poView == 'orderWise'" class="process-table table-padding">
          <table>
            <thead>
              <tr>
                <th style="padding-left: 20px !important">
                  {{ isExport ? "SO#" : "PO#" }}
                </th>
                <th class="width-100">DATE</th>
                <th>CUSTOMER NAME</th>
                <th>VENDOR NAME</th>

                <th class="width-50">INCO</th>
                <th class="width-100">WT ({{ getUomByName("weight") }})</th>
                <th class="width-100">VOL ({{ getUomByName("volume") }})</th>
                <th class="width-70">ODO</th>
                <th class="width-100"># PRODUCT</th>
                <th class="width-100">TOTAL SKUs</th>
                <th class="width-100">REQ. DATE</th>
                <th>
                  PRICE ({{
                    isExport
                      ? getUomByName("exportCost")
                      : getUomByName("importCost")
                  }})
                </th>
                <th>ACTION</th>
              </tr>
            </thead>
            <tbody>
              <ng-container
                *ngFor="let p of containerOrders?.controls; let i = index"
              >
                <tr *ngIf="containerOrders?.controls?.length > 0">
                  <td *ngIf="isExport" style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/purchaseorder/edit',
                        p.value?.purchaseOrderDetail?.id
                      ]"
                    >
                      {{
                        p.get("purchaseOrderDetail").value
                          ?.salesOrderTransactionId
                      }}
                    </a>
                  </td>
                  <td *ngIf="!isExport" style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/purchaseorder/edit',
                        p.value?.purchaseOrderDetail?.id
                      ]"
                    >
                      {{ p.get("purchaseOrderDetail").value?.transactionId }}
                    </a>
                  </td>
                  <td>
                    {{
                      p.get("purchaseOrderDetail").value?.audit?.createdDate
                        | date : "dMMMyy"
                    }}
                  </td>
                  <td>
                    {{ p.get("purchaseOrderDetail").value.requestFrom.name }}
                  </td>
                  <td>
                    {{ p.get("purchaseOrderDetail").value.requestTo.name }}
                  </td>

                  <td>
                    {{
                      getincoTermLabel(
                        p.get("purchaseOrderDetail").value.incoTermId
                      )
                    }}
                  </td>
                  <td class="weight">
                    <div>
                      {{
                        p.get("purchaseOrderDetail").value?.weight
                          ?.attributeValue | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td>
                    <div class="volume">
                      {{
                        p.get("purchaseOrderDetail").value?.volume
                          ?.attributeValue | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td
                    [ngStyle]="{
                      color:
                        p.get('purchaseOrderDetail').value?.odometer
                          ?.odometerType == 'Weight'
                          ? '#03266d'
                          : '#3E7FFF'
                    }"
                  >
                    {{
                      p.get("purchaseOrderDetail").value?.odometer?.odometerType
                        | slice : 0 : 1
                    }}
                    {{ p.get("purchaseOrderDetail").value?.odometer?.value }}
                  </td>
                  <td>
                    {{
                      p.get("purchaseOrderDetail").get("productPackages").value
                        ?.length
                    }}
                  </td>

                  <td>
                    {{ p.get("purchaseOrderDetail").value?.totalSku }}
                  </td>

                  <td>
                    {{
                      p.get("purchaseOrderDetail").value?.requiredByDate
                        | date : "dMMMyy"
                    }}
                  </td>
                  <td class="price-text">
                    {{
                      p.get("purchaseOrderDetail").value?.cost?.attributeValue
                        | numberFormatter : 3
                    }}
                  </td>
                  <td>
                    <dadyin-button
                      (clicked)="removeInContainerOrder(i)"
                      [theme]="'borderless-danger'"
                      type="icon"
                      [typeval]="'delete_outline'"
                    >
                    </dadyin-button>
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>

        <div *ngIf="poView == 'productWise'" class="process-table">
          <table>
            <thead>
              <tr>
                <th style="padding-left: 20px !important">
                  {{ isExport ? "SO#" : "PO#" }}
                </th>
                <th>PRODUCT CODE#</th>
                <th class="width-100">DATE</th>
                <th>CUSTOMER NAME</th>
                <th>VENDOR NAME</th>
                <th class="width-50">INCO</th>
                <th class="width-100">WT ({{ getUomByName("weight") }})</th>
                <th class="width-100">VOL ({{ getUomByName("volume") }})</th>
                <th class="width-70">ODO</th>
                <th class="width-100">TOTAL SKUs</th>
                <th class="width-100">REQ. DATE</th>
                <th>
                  PRICE ({{
                    isExport
                      ? getUomByName("exportCost")
                      : getUomByName("importCost")
                  }})
                </th>
                <th>ACTION</th>
              </tr>
            </thead>
            <tbody>
              <ng-container
                *ngFor="let p of containerOrders?.controls; let i = index"
              >
                <tr
                  [ngClass]="{
                    'b-bottom-primary':
                      getProductPackages(i)?.controls?.length == j + 1
                  }"
                  *ngFor="
                    let item of getProductPackages(i)?.controls;
                    let j = index
                  "
                >
                  <td *ngIf="isExport" style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/purchaseorder/edit',
                        p.value?.purchaseOrderDetail?.id
                      ]"
                    >
                      {{
                        p.get("purchaseOrderDetail").value
                          ?.salesOrderTransactionId
                      }}
                    </a>
                  </td>
                  <td *ngIf="!isExport" style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/purchaseorder/edit',
                        p.value?.purchaseOrderDetail?.id
                      ]"
                    >
                      {{ p.get("purchaseOrderDetail").value?.transactionId }}
                    </a>
                  </td>
                  <td class="d-flex align-items-center">
                    <div
                      style="
                        max-width: 40px;
                        width: 40px;
                        height: 12px !important;
                      "
                      [style.backgroundColor]="
                        this.getColourFromProductCode(
                          item.value.productDetails?.productCode
                        )
                      "
                    ></div>
                    <a
                      container="body"
                      placement="top"
                      [ngbTooltip]="info2"
                      [routerLink]="[
                        '/home/product-management/product/edit',
                        item.value.productDetails?.id
                      ]"
                    >
                      {{ item.value.productDetails?.productCode }}
                    </a>
                    <ng-template #info2>
                      <section>
                        <img
                          [src]="
                            imgUrl +
                            item.value.productDetails.productImageFileNames[0]
                          "
                          width="200"
                          height="200"
                        />
                      </section>
                      <section>
                        {{ item.value.productDetails.description }}
                      </section>
                    </ng-template>
                  </td>
                  <td>
                    {{
                      p.get("purchaseOrderDetail").value.audit.createdDate
                        | date : "dMMMyy"
                    }}
                  </td>
                  <td>
                    {{ p.get("purchaseOrderDetail").value.requestFrom.name }}
                  </td>
                  <td>
                    {{ p.get("purchaseOrderDetail").value.requestTo.name }}
                  </td>
                  <td>
                    {{
                      getincoTermLabel(
                        p.get("purchaseOrderDetail").value.incoTermId
                      )
                    }}
                  </td>
                  <td class="weight">
                    <div>
                      {{
                        item.value.totalWeight?.attributeValue
                          | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td class="volume">
                    <div>
                      {{
                        item.value.totalVolume?.attributeValue
                          | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td
                    [ngStyle]="{
                      color:
                        item.value?.productDetails.skuOdometer?.odometerType ==
                        'Weight'
                          ? '#03266d'
                          : '#3E7FFF'
                    }"
                  >
                    {{
                      item.value?.productDetails.skuOdometer?.odometerType
                        | slice : 0 : 1
                    }}{{ item.value.productDetails.skuOdometer?.value }}
                  </td>
                  <td>
                    {{ item.value.skuQuantities }}
                  </td>
                  <td>
                    {{
                      p.get("purchaseOrderDetail").value?.requiredByDate
                        | date : "dMMMyy"
                    }}
                  </td>
                  <td class="price-text">
                    {{
                      item.value.totalCost?.attributeValue | numberFormatter : 3
                    }}
                  </td>
                  <td></td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>
      </ng-template>
    </mat-expansion-panel>
    <mat-expansion-panel
      class="panel-no-padding my-4"
      expanded="true"
      #expansionPanel4
    >
      <mat-expansion-panel-header
        (click)="expandPanel(expansionPanel4, $event)"
      >
        <div class="font-size-12 d-flex align-items-center width-perc-40">
          <div
            *ngIf="poView == 'orderWise'"
            class="text-left fw-bold title-text me-2"
            style="white-space: nowrap"
          >
            {{ isExport ? "SOs" : "POs" }} Not in Container ({{
              getFilteredPOs()?.length
            }})
          </div>

          <div
            *ngIf="poView == 'productWise'"
            class="text-left fw-bold w-100 title-text me-2"
            style="white-space: nowrap"
          >
            Products Not in Container Overview
          </div>

          <div class="new-filed width-perc-100">
            <input
              type="text"
              class="width-perc-100"
              [formControl]="filterTermPo"
              placeholder="Search Purchase Order/Product"
            />
          </div>
        </div>
      </mat-expansion-panel-header>

      <ng-template matExpansionPanelContent>
        <div *ngIf="poView == 'orderWise'" class="process-table table-padding">
          <table>
            <thead>
              <tr>
                <th
                  (click)="sortData('transactionId')"
                  style="cursor: pointer; padding-left: 20px !important"
                >
                  {{ isExport ? "SO#" : "PO#" }}
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("transactionId") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('audit.createdDate')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  DATE
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("audit.createdDate") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('requestFrom.name')"
                  style="cursor: pointer"
                >
                  CUSTOMER NAME
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("requestFrom.name") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('requestTo.name')"
                  style="cursor: pointer"
                >
                  VENDOR NAME
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("requestTo.name") }}
                  </mat-icon>
                </th>
                <th class="width-50">INCO</th>
                <th
                  (click)="sortData('weight.attributeValue')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  WT ({{ getUomByName("weight") }})
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("weight.attributeValue") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('volume.attributeValue')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  VOL ({{ getUomByName("volume") }})
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("volume.attributeValue") }}
                  </mat-icon>
                </th>
                <th class="width-70">ODO</th>
                <th
                  (click)="sortData('productPackages.length')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  # PRODUCT

                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("productPackages.length") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('totalSku')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  TOTAL SKUs
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("totalSku") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('requiredByDate')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  REQ. DATE
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("requiredByDate") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('cost.attributeValue')"
                  style="cursor: pointer"
                >
                  PRICE ({{
                    isExport
                      ? getUomByName("exportCost")
                      : getUomByName("importCost")
                  }})
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("cost.attributeValue") }}
                  </mat-icon>
                </th>
                <th>ACTION</th>
              </tr>
            </thead>
            <tbody>
              <ng-container *ngFor="let p of sortedData(); let i = index">
                <tr>
                  <td *ngIf="isExport" style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/purchaseorder/edit',
                        p.id
                      ]"
                    >
                      {{ p.salesOrdertransactionId }}
                    </a>
                  </td>
                  <td *ngIf="!isExport" style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/purchaseorder/edit',
                        p.id
                      ]"
                    >
                      {{ p.transactionId }}
                    </a>
                  </td>
                  <td>
                    {{ p.audit?.createdDate | date : "dMMMyy" }}
                  </td>
                  <td>
                    {{ p.requestFrom.name }}
                  </td>
                  <td>
                    {{ p.requestTo.name }}
                  </td>
                  <td>
                    {{ getincoTermLabel(p?.incoTermId) }}
                  </td>
                  <td class="weight">
                    <div>
                      {{ p.weight.attributeValue | numberFormatter : 3 }}
                    </div>
                  </td>
                  <td class="volume">
                    <div>
                      {{ p.volume.attributeValue | numberFormatter : 3 }}
                    </div>
                  </td>
                  <td>
                    {{ p.odometer?.odometerType | slice : 0 : 1
                    }}{{ p.odometer?.value }}
                  </td>
                  <td>
                    {{ p.productPackages.length }}
                  </td>
                  <td>
                    {{ p?.totalSku }}
                  </td>
                  <td>
                    {{ p.requiredByDate | date : "dMMMyy" }}
                  </td>
                  <td class="price-text">
                    {{ p.cost?.attributeValue | numberFormatter : 3 }}
                  </td>
                  <td>
                    <dadyin-button
                      [isDisabled]="
                        p?.requestTo?.id != this.requestFromId?.value &&
                        containerOrders?.controls?.length > 0
                      "
                      (clicked)="addInContainerOrder(p)"
                      [theme]="'borderless-primary'"
                      type="image"
                      [typeval]="'assets/img/icons/add-dash.svg'"
                    >
                    </dadyin-button>
                    <dadyin-button
                      tooltip="Refresh Updated Purchase order information"
                      (clicked)="refreshPo(p, i)"
                      [theme]="'borderless-primary'"
                      type="icon"
                      typeval="sync"
                    >
                    </dadyin-button>
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>

        <div *ngIf="poView == 'productWise'" class="process-table">
          <table>
            <thead>
              <tr>
                <th
                  (click)="sortData('transactionId')"
                  style="padding-left: 20px !important"
                >
                  {{ isExport ? "SO#" : "PO#" }}

                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("transactionId") }}
                  </mat-icon>
                </th>
                <th>PRODUCT CODE#</th>
                <th (click)="sortData('audit.createdDate')" class="width-100">
                  DATE
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("audit.createdDate") }}
                  </mat-icon>
                </th>
                <th>CUSTOMER NAME</th>
                <th>VENDOR NAME</th>
                <th class="width-50">INCO</th>
                <th class="width-100">WT ({{ getUomByName("weight") }})</th>
                <th class="width-100">VOL ({{ getUomByName("volume") }})</th>
                <th class="width-70">ODO</th>
                <th class="width-100">TOTAL SKUs</th>
                <th (click)="sortData('requiredByDate')" class="width-100">
                  REQ. DATE
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("requiredByDate") }}
                  </mat-icon>
                </th>
                <th>
                  PRICE ({{
                    isExport
                      ? getUomByName("exportCost")
                      : getUomByName("importCost")
                  }})
                </th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <ng-container *ngFor="let order of sortedData(); let i = index">
                <tr
                  [ngClass]="{
                    'b-bottom-primary': order?.productPackages?.length == j + 1
                  }"
                  *ngFor="let product of order?.productPackages; let j = index"
                >
                  <td *ngIf="isExport" style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/purchaseorder/edit',
                        order.id
                      ]"
                    >
                      {{ order.salesOrdertransactionId }}
                    </a>
                  </td>
                  <td *ngIf="!isExport" style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/purchaseorder/edit',
                        order.id
                      ]"
                    >
                      {{ order.transactionId }}
                    </a>
                  </td>
                  <td class="d-flex align-items-center">
                    <div
                      style="
                        max-width: 40px;
                        width: 40px;
                        height: 12px !important;
                      "
                      [style.backgroundColor]="
                        this.getColourFromProductCode(
                          product.productDetails.productCode
                        )
                      "
                    ></div>
                    <a
                      container="body"
                      placement="top"
                      [ngbTooltip]="info1"
                      [routerLink]="[
                        '/home/product-management/product/edit',
                        product.productId
                      ]"
                    >
                      {{ product.productDetails.productCode }}
                    </a>
                    <ng-template #info1>
                      <section>
                        <img
                          [src]="
                            imgUrl +
                            product.productDetails.productImageFileNames[0]
                          "
                          width="200"
                          height="200"
                        />
                      </section>
                      <section>
                        {{ product.productDetails.description }}
                      </section>
                    </ng-template>
                  </td>
                  <td>
                    {{ order?.audit.createdDate | date : "dMMMyy" }}
                  </td>
                  <td>
                    {{ order.requestFrom.name }}
                  </td>
                  <td>
                    {{ order.requestTo.name }}
                  </td>
                  <td>
                    {{ getincoTermLabel(order?.incoTermId) }}
                  </td>
                  <td class="weight">
                    <div>
                      {{
                        product?.totalWeight?.attributeValue
                          | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td class="volume">
                    <div>
                      {{
                        product?.totalVolume?.attributeValue
                          | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td
                    [ngStyle]="{
                      color:
                        product?.productDetails.skuOdometer?.odometerType ==
                        'Weight'
                          ? '#03266d'
                          : '#3E7FFF'
                    }"
                  >
                    {{
                      product?.productDetails.skuOdometer?.odometerType
                        | slice : 0 : 1
                    }}{{ product?.productDetails.skuOdometer?.value }}
                  </td>
                  <td>
                    {{ product?.skuQuantities }}
                  </td>
                  <td>
                    {{ order.requiredByDate | date : "dMMMyy" }}
                  </td>
                  <td class="price-text">
                    {{
                      product?.totalCost?.attributeValue | numberFormatter : 3
                    }}
                  </td>
                  <td></td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>
      </ng-template>
    </mat-expansion-panel>
    <!-- end -->
  </ng-container>

  <ng-container *ngIf="isQuotation">
    <!-- // related to quotations  -->

    <mat-expansion-panel
      class="panel-no-padding mt-4"
      expanded="true"
      #expansionPanel3
    >
      <mat-expansion-panel-header
        (click)="expandPanel(expansionPanel5, $event)"
      >
        <mat-panel-description>
          <div
            *ngIf="poView == 'orderWise'"
            class="text-center w-100 title-text"
          >
            Quotations in Container ({{
              containerQuotations?.controls?.length
            }})
          </div>
          <div *ngIf="poView == 'productWise'" class="w-100 title-text">
            Products in Container ({{ containerQuotations?.controls?.length }})
          </div>
        </mat-panel-description>
      </mat-expansion-panel-header>

      <ng-template matExpansionPanelContent>
        <div *ngIf="poView == 'orderWise'" class="process-table table-padding">
          <table>
            <thead>
              <tr>
                <th style="padding-left: 20px !important">QUO#</th>
                <th class="width-100">DATE</th>
                <th>CUSTOMER NAME</th>
                <th>VENDOR NAME</th>

                <th class="width-50">INCO</th>
                <th class="width-100">WT ({{ getUomByName("weight") }})</th>
                <th class="width-100">VOL ({{ getUomByName("volume") }})</th>
                <th class="width-70">ODO</th>
                <th class="width-100"># PRODUCT</th>
                <th class="width-100">TOTAL SKUs</th>
                <th class="width-100">REQ. DATE</th>
                <th>
                  PRICE ({{
                    isExport
                      ? getUomByName("exportCost")
                      : getUomByName("importCost")
                  }})
                </th>
                <th>ACTION</th>
              </tr>
            </thead>
            <tbody>
              <ng-container
                *ngFor="
                  let quotation of containerQuotations?.controls;
                  let i = index
                "
              >
                <tr *ngIf="containerQuotations?.controls?.length > 0">
                  <td style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/quotation/edit',
                        quotation.value?.quotationListView?.id
                      ]"
                    >
                      {{
                        quotation.get("quotationListView").value?.transactionId
                      }}
                    </a>
                  </td>

                  <td>
                    {{
                      quotation.get("quotationListView").value?.audit
                        ?.createdDate | date : "dMMMyy"
                    }}
                  </td>
                  <td>
                    {{
                      quotation.get("quotationListView").value.requestFrom.name
                    }}
                  </td>
                  <td>
                    {{
                      quotation.get("quotationListView").value.requestTo.name
                    }}
                  </td>

                  <td>
                    {{
                      getincoTermLabel(
                        quotation.get("quotationListView").value.incoTermId
                      )
                    }}
                  </td>
                  <td class="weight">
                    <div>
                      {{
                        quotation.get("quotationListView").value?.weight
                          ?.attributeValue | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td>
                    <div class="volume">
                      {{
                        quotation.get("quotationListView").value?.volume
                          ?.attributeValue | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td
                    [ngStyle]="{
                      color:
                        quotation.get('quotationListView').value?.odometer
                          ?.odometerType == 'Weight'
                          ? '#03266d'
                          : '#3E7FFF'
                    }"
                  >
                    {{
                      quotation.get("quotationListView").value?.odometer
                        ?.odometerType | slice : 0 : 1
                    }}
                    {{
                      quotation.get("quotationListView").value?.odometer?.value
                    }}
                  </td>
                  <td>
                    {{
                      quotation.get("quotationListView").get("productPackages")
                        .value?.length
                    }}
                  </td>

                  <td>
                    {{ quotation.get("quotationListView").value?.totalSku }}
                  </td>

                  <td>
                    {{
                      quotation.get("quotationListView").value?.requiredByDate
                        | date : "dMMMyy"
                    }}
                  </td>
                  <td class="price-text">
                    {{
                      quotation.get("quotationListView").value?.cost
                        ?.attributeValue | numberFormatter : 3
                    }}
                  </td>
                  <td>
                    <dadyin-button
                      (clicked)="removeInContainerQuotation(i)"
                      [theme]="'borderless-danger'"
                      type="icon"
                      [typeval]="'delete_outline'"
                    >
                    </dadyin-button>
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>

        <div *ngIf="poView == 'productWise'" class="process-table">
          <table>
            <thead>
              <tr>
                <th style="padding-left: 20px !important">
                  {{ isExport ? "SO#" : "PO#" }}
                </th>
                <th>PRODUCT CODE#</th>
                <th class="width-100">DATE</th>
                <th>CUSTOMER NAME</th>
                <th>VENDOR NAME</th>
                <th class="width-50">INCO</th>
                <th class="width-100">WT ({{ getUomByName("weight") }})</th>
                <th class="width-100">VOL ({{ getUomByName("volume") }})</th>
                <th class="width-70">ODO</th>
                <th class="width-100">TOTAL SKUs</th>
                <th class="width-100">REQ. DATE</th>
                <th>
                  PRICE ({{
                    isExport
                      ? getUomByName("exportCost")
                      : getUomByName("importCost")
                  }})
                </th>
                <th>ACTION</th>
              </tr>
            </thead>
            <tbody>
              <ng-container
                *ngFor="
                  let quotation of containerQuotations?.controls;
                  let i = index
                "
              >
                <tr
                  [ngClass]="{
                    'b-bottom-primary':
                      getProductPackagesQuotation(i)?.controls?.length == j + 1
                  }"
                  *ngFor="
                    let item of getProductPackagesQuotation(i)?.controls;
                    let j = index
                  "
                >
                  <td *ngIf="isExport" style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/quotation/edit',
                        quotation.value?.quotationListView?.id
                      ]"
                    >
                      {{
                        quotation.get("quotationListView").value?.transactionId
                      }}
                    </a>
                  </td>
                  <td *ngIf="!isExport" style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/quotation/edit',
                        quotation.value?.quotationListView?.id
                      ]"
                    >
                      {{
                        quotation.get("quotationListView").value?.transactionId
                      }}
                    </a>
                  </td>
                  <td class="d-flex align-items-center">
                    <div
                      style="
                        max-width: 40px;
                        width: 40px;
                        height: 12px !important;
                      "
                      [style.backgroundColor]="
                        this.getColourFromProductCode(
                          item.value.productDetails?.productCode
                        )
                      "
                    ></div>
                    <a
                      container="body"
                      placement="top"
                      [ngbTooltip]="info2"
                      [routerLink]="[
                        '/home/product-management/product/edit',
                        item.value.productDetails?.id
                      ]"
                    >
                      {{ item.value.productDetails?.productCode }}
                    </a>
                    <ng-template #info2>
                      <section>
                        <img
                          [src]="
                            imgUrl +
                            item.value.productDetails.productImageFileNames[0]
                          "
                          width="200"
                          height="200"
                        />
                      </section>
                      <section>
                        {{ item.value.productDetails.description }}
                      </section>
                    </ng-template>
                  </td>
                  <td>
                    {{
                      quotation.get("quotationListView").value.audit.createdDate
                        | date : "dMMMyy"
                    }}
                  </td>
                  <td>
                    {{
                      quotation.get("quotationListView").value.requestFrom.name
                    }}
                  </td>
                  <td>
                    {{
                      quotation.get("quotationListView").value.requestTo.name
                    }}
                  </td>
                  <td>
                    {{
                      getincoTermLabel(
                        quotation.get("quotationListView").value.incoTermId
                      )
                    }}
                  </td>
                  <td class="weight">
                    <div>
                      {{
                        item.value.totalWeight?.attributeValue
                          | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td class="volume">
                    <div>
                      {{
                        item.value.totalVolume?.attributeValue
                          | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td
                    [ngStyle]="{
                      color:
                        item.value?.productDetails.skuOdometer?.odometerType ==
                        'Weight'
                          ? '#03266d'
                          : '#3E7FFF'
                    }"
                  >
                    {{
                      item.value?.productDetails.skuOdometer?.odometerType
                        | slice : 0 : 1
                    }}{{ item.value.productDetails.skuOdometer?.value }}
                  </td>
                  <td>
                    {{ item.value.skuQuantities }}
                  </td>
                  <td>
                    {{
                      quotation.get("purchaseOrderDetail").value?.requiredByDate
                        | date : "dMMMyy"
                    }}
                  </td>
                  <td class="price-text">
                    {{
                      item.value.totalCost?.attributeValue | numberFormatter : 3
                    }}
                  </td>
                  <td></td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>
      </ng-template>
    </mat-expansion-panel>
    <mat-expansion-panel
      class="panel-no-padding my-4"
      expanded="true"
      #expansionPanel6
    >
      <mat-expansion-panel-header
        (click)="expandPanel(expansionPanel6, $event)"
      >
        <div class="font-size-12 d-flex align-items-center width-perc-40">
          <div
            *ngIf="poView == 'orderWise'"
            class="text-left title-text me-2"
            style="white-space: nowrap"
          >
            Quotations Not in Container ({{ getFilteredQuotations()?.length }})
          </div>

          <div
            *ngIf="poView == 'productWise'"
            class="text-left w-100 title-text me-2"
            style="white-space: nowrap"
          >
            Products Not in Container Overview
          </div>

          <div class="new-filed width-perc-100">
            <input
              type="text"
              class="width-perc-100"
              [formControl]="filterTermQuotation"
              placeholder="Search quotation"
            />
          </div>
        </div>
      </mat-expansion-panel-header>

      <ng-template matExpansionPanelContent>
        <div *ngIf="poView == 'orderWise'" class="process-table table-padding">
          <table>
            <thead>
              <tr>
                <th
                  (click)="sortData('transactionId')"
                  style="cursor: pointer; padding-left: 20px !important"
                >
                  {{ isExport ? "SO#" : "PO#" }}
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("transactionId") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('audit.createdDate')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  DATE
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("audit.createdDate") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('requestFrom.name')"
                  style="cursor: pointer"
                >
                  CUSTOMER NAME
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("requestFrom.name") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('requestTo.name')"
                  style="cursor: pointer"
                >
                  VENDOR NAME
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("requestTo.name") }}
                  </mat-icon>
                </th>
                <th class="width-50">INCO</th>
                <th
                  (click)="sortData('weight.attributeValue')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  WT ({{ getUomByName("weight") }})
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("weight.attributeValue") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('volume.attributeValue')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  VOL ({{ getUomByName("volume") }})
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("volume.attributeValue") }}
                  </mat-icon>
                </th>
                <th class="width-70">ODO</th>
                <th
                  (click)="sortData('productPackages.length')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  # PRODUCT

                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("productPackages.length") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('totalSku')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  TOTAL SKUs
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("totalSku") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('requiredByDate')"
                  class="width-100"
                  style="cursor: pointer"
                >
                  REQ. DATE
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("requiredByDate") }}
                  </mat-icon>
                </th>
                <th
                  (click)="sortData('cost.attributeValue')"
                  style="cursor: pointer"
                >
                  PRICE ({{
                    isExport
                      ? getUomByName("exportCost")
                      : getUomByName("importCost")
                  }})
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("cost.attributeValue") }}
                  </mat-icon>
                </th>
                <th>ACTION</th>
              </tr>
            </thead>
            <tbody>
              <ng-container
                *ngFor="let quotation of sortedQuotationsData(); let i = index"
              >
                <tr>
                  <td style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/quotation/edit',
                        quotation.id
                      ]"
                    >
                      {{ quotation.transactionId }}
                    </a>
                  </td>

                  <td>
                    {{ quotation.audit?.createdDate | date : "dMMMyy" }}
                  </td>
                  <td>
                    {{ quotation.requestFrom.name }}
                  </td>
                  <td>
                    {{ quotation.requestTo.name }}
                  </td>
                  <td>
                    {{ getincoTermLabel(p?.incoTermId) }}
                  </td>
                  <td class="weight">
                    <div>
                      {{
                        quotation.weight.attributeValue | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td class="volume">
                    <div>
                      {{
                        quotation.volume.attributeValue | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td>
                    {{ quotation.odometer?.odometerType | slice : 0 : 1
                    }}{{ quotation.odometer?.value }}
                  </td>
                  <td>
                    {{ quotation.productPackages.length }}
                  </td>
                  <td>
                    {{ quotation.totalSku }}
                  </td>
                  <td>
                    {{ quotation.requiredByDate | date : "dMMMyy" }}
                  </td>
                  <td class="price-text">
                    {{ quotation.cost?.attributeValue | numberFormatter : 3 }}
                  </td>
                  <td>
                    <dadyin-button
                      (clicked)="addInContainerQuotation(quotation)"
                      [theme]="'borderless-primary'"
                      type="image"
                      [typeval]="'assets/img/icons/add-dash.svg'"
                    >
                    </dadyin-button>
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>

        <div *ngIf="poView == 'productWise'" class="process-table">
          <table>
            <thead>
              <tr>
                <th
                  (click)="sortData('transactionId')"
                  style="padding-left: 20px !important"
                >
                  QO#

                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("transactionId") }}
                  </mat-icon>
                </th>
                <th>PRODUCT CODE#</th>
                <th (click)="sortData('audit.createdDate')" class="width-100">
                  DATE
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("audit.createdDate") }}
                  </mat-icon>
                </th>
                <th>CUSTOMER NAME</th>
                <th>VENDOR NAME</th>
                <th class="width-50">INCO</th>
                <th class="width-100">WT ({{ getUomByName("weight") }})</th>
                <th class="width-100">VOL ({{ getUomByName("volume") }})</th>
                <th class="width-70">ODO</th>
                <th class="width-100">TOTAL SKUs</th>
                <th (click)="sortData('requiredByDate')" class="width-100">
                  REQ. DATE
                  <mat-icon class="material-icon sort-icon">
                    {{ getSortIcon("requiredByDate") }}
                  </mat-icon>
                </th>
                <th>
                  PRICE ({{
                    isExport
                      ? getUomByName("exportCost")
                      : getUomByName("importCost")
                  }})
                </th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <ng-container
                *ngFor="let quotation of sortedQuotationsData(); let i = index"
              >
                <tr
                  [ngClass]="{
                    'b-bottom-primary':
                      quotation?.productPackages?.length == j + 1
                  }"
                  *ngFor="
                    let product of quotation?.productPackages;
                    let j = index
                  "
                >
                  <td style="padding-left: 20px !important">
                    <a
                      [routerLink]="[
                        '/home/order-management/vendor/quotation/edit',
                        quotation.id
                      ]"
                    >
                      {{ quotation.transactionId }}
                    </a>
                  </td>
                  <td class="d-flex align-items-center">
                    <div
                      style="
                        max-width: 40px;
                        width: 40px;
                        height: 12px !important;
                      "
                      [style.backgroundColor]="
                        this.getColourFromProductCode(
                          product.productDetails.productCode
                        )
                      "
                    ></div>
                    <a
                      container="body"
                      placement="top"
                      [ngbTooltip]="info1"
                      [routerLink]="[
                        '/home/product-management/product/edit',
                        product.productId
                      ]"
                    >
                      {{ product.productDetails.productCode }}
                    </a>
                    <ng-template #info1>
                      <section>
                        <img
                          [src]="
                            imgUrl +
                            product.productDetails.productImageFileNames[0]
                          "
                          width="200"
                          height="200"
                        />
                      </section>
                      <section>
                        {{ product.productDetails.description }}
                      </section>
                    </ng-template>
                  </td>
                  <td>
                    {{ quotation.audit.createdDate | date : "dMMMyy" }}
                  </td>
                  <td>
                    {{ quotation.requestFrom.name }}
                  </td>
                  <td>
                    {{ quotation.requestTo.name }}
                  </td>
                  <td>
                    {{ getincoTermLabel(quotation.incoTermId) }}
                  </td>
                  <td class="weight">
                    <div>
                      {{
                        product?.totalWeight?.attributeValue
                          | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td class="volume">
                    <div>
                      {{
                        product?.totalVolume?.attributeValue
                          | numberFormatter : 3
                      }}
                    </div>
                  </td>
                  <td
                    [ngStyle]="{
                      color:
                        product?.productDetails.skuOdometer?.odometerType ==
                        'Weight'
                          ? '#03266d'
                          : '#3E7FFF'
                    }"
                  >
                    {{
                      product?.productDetails.skuOdometer?.odometerType
                        | slice : 0 : 1
                    }}{{ product?.productDetails.skuOdometer?.value }}
                  </td>
                  <td>
                    {{ product?.skuQuantities }}
                  </td>
                  <td>
                    {{ quotation.requiredByDate | date : "dMMMyy" }}
                  </td>
                  <td class="price-text">
                    {{
                      product?.totalCost?.attributeValue | numberFormatter : 3
                    }}
                  </td>
                  <td></td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>
      </ng-template>
    </mat-expansion-panel>
  </ng-container>

  <!-- end -->

  <div class="d-flex justify-content-end align-items-center">
    <dadyin-button
      [theme]="'secondary'"
      label="Get Quick Quotations"
      height="33px"
    >
    </dadyin-button>
  </div>

  <mat-expansion-panel
    class="panel-no-padding my-4"
    expanded="true"
    #expansionPanel5
  >
    <mat-expansion-panel-header (click)="expandPanel(expansionPanel5, $event)">
      <div class="font-size-12 d-flex align-items-center width-perc-40">
        <div class="text-left w-100 title-text fw-bold">Received Quotations</div>
      </div>
    </mat-expansion-panel-header>

    <ng-template matExpansionPanelContent>
      <div class="process-table">
        <table>
          <thead>
            <tr>
              <th style="padding-left: 20px !important">SERVICE</th>
              <th>SERVICE PROVIDER</th>
              <th>CONTACT DETAILS</th>
              <th>QUOTATED AMOUNT</th>
              <th>PAYMENT TYPE</th>
              <th>ACTION</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </ng-template>
  </mat-expansion-panel>
</form>
